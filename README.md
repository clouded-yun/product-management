# 产品参数管理系统

一个功能完善的产品参数录入和管理Web应用，支持自定义表格列、多界面管理、图片上传和数据导出等功能。

## 功能特点

### 1. 产品参数录入
- 支持表格形式的数据录入
- 支持多种字段类型：文本、数字、多行文本、图片
- 图片自动压缩，支持预览和点击放大
- 方便的数据编辑和删除功能

### 2. 高度可定制
- **自定义列定义**：可以为每个界面自定义表格列头
  - 列名（键）：用于数据存储的唯一标识
  - 显示名称：表格列头显示的文字
  - 数据类型：文本、数字、多行文本、图片
- **多界面管理**：可以创建多个数据界面（如产品参数、产品类型等）
  - 每个界面可以独立配置列定义
  - 每个界面有独立的数据存储空间
  - 界面名称可自定义

### 3. 用户权限系统
- **管理员（admin）**：
  - 可以创建和编辑数据界面
  - 可以添加、编辑、删除数据记录
  - 可以导出数据（CSV、JSON格式）
  - 可以管理列定义
- **普通用户（user）**：
  - 只能查看数据
  - 可以导出数据（CSV、JSON格式）
  - 无法编辑数据或界面配置

## 项目结构

```
product_management_demo/
├── index.html              # HTML入口文件
├── package.json            # 项目配置文件
├── vite.config.js          # Vite构建配置
├── README.md               # 功能说明文档（本文件）
├── public/                 # 静态资源目录
└── src/
    ├── main.jsx            # React应用入口
    ├── App.jsx             # 主应用组件
    ├── components/         # React组件目录
    │   ├── Login.jsx       # 登录组件
    │   ├── MainLayout.jsx  # 主布局组件
    │   ├── DataTable.jsx   # 数据表格组件
    │   ├── ColumnEditor.jsx # 列编辑器组件
    │   ├── PageManager.jsx # 界面管理组件
    │   └── BackupRestore.jsx # 备份恢复组件
    ├── utils/              # 工具函数目录
    │   ├── storage.js      # 本地存储工具
    │   ├── imageUtils.js   # 图片处理工具
    │   ├── exportUtils.js  # 数据导出工具
    │   └── backupUtils.js  # 备份恢复工具
    └── styles/             # 样式文件目录
        ├── index.css       # 全局样式
        ├── App.css         # 应用样式
        ├── Login.css       # 登录页面样式
        ├── MainLayout.css  # 主布局样式
        ├── DataTable.css   # 数据表格样式
        ├── ColumnEditor.css # 列编辑器样式
        ├── PageManager.css # 界面管理样式
        └── BackupRestore.css # 备份恢复样式
```

## 安装和运行

### 前置要求
- Node.js (版本 14 或更高)
- npm 或 yarn

### 安装步骤

1. **安装依赖**
   ```bash
   cd product_management_demo
   npm install
   ```

2. **启动开发服务器**
   ```bash
   npm run dev
   ```

3. **构建生产版本**
   ```bash
   npm run build
   ```

4. **预览生产版本**
   ```bash
   npm run preview
   ```

## 使用说明

### 初始登录

系统首次运行时会自动创建一个默认管理员账号：
- **用户名**：`admin`
- **密码**：`admin123`
- **角色**：管理员

### 创建新账号

1. 在登录页面点击"创建新账号"
2. 填写用户名、密码
3. 选择角色（普通用户或管理员）
4. 点击"创建"按钮

### 管理员操作指南

#### 1. 创建数据界面

1. 登录后，点击右上角的"界面管理"按钮
2. 点击"创建新界面"按钮
3. 输入界面名称（如"产品参数"、"产品类型"等）
4. 点击"保存"

#### 2. 配置表格列

1. 在数据界面中，点击"编辑列"按钮
2. 为每一列设置：
   - **列名（键）**：英文标识符，用于数据存储（如：product_name, price）
   - **显示名称**：表格列头显示的中文名称（如：产品名称、价格）
   - **类型**：选择字段类型
     - 文本：普通文本输入
     - 数字：数字输入
     - 多行文本：文本域输入
     - 图片：图片上传
3. 点击"添加列"可以增加新列
4. 点击"删除"可以移除列
5. 配置完成后点击"保存"

#### 3. 添加数据记录

1. 选择要操作的数据界面
2. 点击"添加记录"按钮
3. 在弹出的表单中填写各个字段：
   - 文本字段：直接输入
   - 数字字段：输入数字
   - 多行文本：在文本域中输入
   - 图片字段：点击文件选择按钮，选择图片文件
4. 点击"保存"按钮保存记录

#### 4. 编辑数据记录

1. 在数据表格中找到要编辑的记录
2. 点击该记录行的"编辑"按钮
3. 修改字段内容
4. 点击"保存"按钮

#### 5. 删除数据记录

1. 在数据表格中找到要删除的记录
2. 点击该记录行的"删除"按钮
3. 确认删除操作

#### 6. 导出数据

1. 在数据界面中，点击"导出CSV"或"导出JSON"按钮
2. 文件会自动下载到本地

#### 7. 数据备份与恢复

**备份数据（更新代码前必须操作）**：
1. 点击右上角的"备份/恢复"按钮
2. 点击"导出备份文件"按钮
3. 备份文件会自动下载（文件名包含时间戳）
4. 备份文件包含：所有用户账号、所有界面配置、所有数据记录

**恢复数据（更新代码后使用）**：
1. 更新代码后，打开新版本的系统
2. 点击"备份/恢复"按钮
3. 点击"选择备份文件"，选择之前导出的备份文件
4. 等待导入完成，系统会显示恢复结果
5. 建议刷新页面以确保数据完全加载
6. 恢复后需要重新登录

#### 8. 管理界面

1. 点击"界面管理"按钮
2. 可以编辑界面名称
3. 可以删除界面（注意：删除界面会同时删除该界面的所有数据）

### 普通用户操作指南

1. 登录后，在左侧侧边栏选择要查看的数据界面
2. 查看数据表格
3. 可以点击"导出CSV"或"导出JSON"导出数据
4. 无法添加、编辑或删除数据
5. 无法访问"界面管理"功能

## 技术实现

### 核心技术栈
- **React 18**：前端框架
- **Vite**：构建工具和开发服务器
- **LocalStorage**：数据持久化存储

### 数据存储结构

#### 用户数据 (users)
```javascript
[
  {
    id: "1",
    username: "admin",
    password: "admin123",
    role: "admin" // 或 "user"
  }
]
```

#### 界面配置 (pageConfigs)
```javascript
[
  {
    id: "1234567890",
    name: "产品参数",
    columns: [
      {
        key: "product_name",
        label: "产品名称",
        type: "text"
      },
      {
        key: "price",
        label: "价格",
        type: "number"
      },
      {
        key: "image",
        label: "产品图片",
        type: "image"
      }
    ]
  }
]
```

#### 页面数据 (pageData)
```javascript
{
  "1234567890": [
    {
      id: "9876543210",
      product_name: "示例产品",
      price: 99.99,
      image: "data:image/jpeg;base64,..."
    }
  ]
}
```

### 主要组件说明

#### Login.jsx
- 功能：用户登录和账号创建
- 特性：
  - 用户认证
  - 新账号创建
  - 默认管理员初始化

#### MainLayout.jsx
- 功能：主应用布局
- 特性：
  - 顶部导航栏
  - 左侧界面列表
  - 右侧内容区域
  - 用户信息显示
  - 权限控制

#### DataTable.jsx
- 功能：数据表格显示和编辑
- 特性：
  - 数据展示
  - 添加/编辑/删除记录
  - 图片预览
  - 数据导出
  - 列编辑入口

#### ColumnEditor.jsx
- 功能：表格列定义编辑
- 特性：
  - 添加/删除列
  - 配置列属性
  - 支持多种数据类型

#### PageManager.jsx
- 功能：数据界面管理
- 特性：
  - 创建新界面
  - 编辑界面名称
  - 删除界面

#### BackupRestore.jsx
- 功能：数据备份与恢复
- 特性：
  - 导出完整备份（用户、配置、数据）
  - 从备份文件恢复所有数据
  - 备份文件信息显示

### 工具函数说明

#### storage.js
- `getItem(key)`: 从localStorage读取数据
- `setItem(key, value)`: 保存数据到localStorage
- `getUsers()`: 获取用户列表
- `saveUsers(users)`: 保存用户列表
- `getCurrentUser()`: 获取当前登录用户
- `setCurrentUser(user)`: 设置当前用户
- `logout()`: 退出登录
- `getPageConfigs()`: 获取界面配置列表
- `savePageConfigs(configs)`: 保存界面配置
- `getData(pageId)`: 获取指定界面的数据
- `saveData(pageId, data)`: 保存指定界面的数据

#### imageUtils.js
- `fileToBase64(file)`: 将图片文件转换为base64字符串
- `compressImage(base64, maxWidth, quality)`: 压缩图片以减少存储空间

#### exportUtils.js
- `exportToCSV(data, columns, filename)`: 导出数据为CSV格式
- `exportToJSON(data, filename)`: 导出数据为JSON格式

## 注意事项

1. **数据存储**：所有数据存储在浏览器的LocalStorage中，清除浏览器数据会导致数据丢失。生产环境建议使用后端数据库。

2. **图片存储**：图片以base64格式存储在LocalStorage中，大量图片可能导致存储空间不足。建议限制单张图片大小或使用图片服务器。

3. **安全性**：当前版本的密码以明文形式存储，仅适用于演示和内部使用。生产环境应使用密码加密和HTTPS。

4. **浏览器兼容性**：建议使用现代浏览器（Chrome、Firefox、Edge、Safari最新版本）。

5. **数据备份与恢复**：
   - **更新代码前务必备份**：使用"备份/恢复"功能导出完整备份文件
   - 备份文件包含所有配置和数据，更新代码后可以完整恢复
   - 建议定期备份重要数据，避免数据丢失
   - 备份文件为JSON格式，可以安全地在不同浏览器和设备间传输

## 扩展建议

1. **后端集成**：将数据存储迁移到后端数据库（MySQL、MongoDB等）
2. **用户认证增强**：实现JWT令牌、密码加密、会话管理
3. **图片服务**：使用专业的图片存储服务（如OSS、CDN）
4. **数据导入**：支持从CSV/JSON文件导入数据
5. **高级搜索**：添加数据搜索和筛选功能
6. **数据验证**：添加字段验证规则（必填、格式、范围等）
7. **批量操作**：支持批量导入、导出、删除
8. **权限细化**：支持更细粒度的权限控制
9. **数据统计**：添加数据统计和图表展示功能
10. **移动端适配**：优化移动设备显示效果

## 版本历史

### v1.2.1 (2024-01-13)
- 筛选功能优化：改为按钮触发，筛选图标放在列名末尾，点击后显示筛选框
- 列宽自动调整和手动调整功能（管理员可拖拽列边界调整列宽）
- 导入文件优化：智能识别导入文件的列，自动映射到WEB列格式（无需严格匹配）

### v1.2.0 (2024-01-13)
- 列编辑器支持列顺序调整（上移/下移）
- 列定义支持添加说明字段（输入时显示问号提示）
- 数字类型支持0和空值（空值显示为NONE）
- 新增选择类型（下拉选项）
- 数据表格添加筛选功能
- 支持批量选择和多选导出
- 新增数据导入功能（支持CSV和JSON格式）

### v1.1.0 (2024-01-13)
- 新增数据备份与恢复功能
- 支持完整数据导出和导入
- 方便代码更新后数据迁移

### v1.0.0 (2024-01-13)
- 初始版本发布
- 实现基本的产品参数录入功能
- 支持自定义列定义和多界面管理
- 实现用户权限系统
- 支持图片上传和数据导出

## 许可证

本项目仅供学习和演示使用。

## 联系方式

如有问题或建议，请通过项目仓库提交Issue。

